<!-- Save this file as `music-player.html` and open in Chrome -->
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>End of Day Chill üåô</title>
  <style>
    :root {
      --bg1:#0f1724;
      --bg2:#201b45;
      --bg3:#10223b;
      --card:#0b1220;
      --accent:#7c3aed;
      --muted:#94a3b8;
      --glass:rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, Arial}

    /* üåà N·ªÅn gradient ƒë·ªông */
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#e6eef8;
      background:linear-gradient(-45deg,var(--bg1),var(--bg2),var(--bg3),#071428);
      background-size:400% 400%;
      animation:bgShift 12s ease infinite;
    }
    @keyframes bgShift {
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    /* ‚ú® Hi·ªáu ·ª©ng glow nh·∫π quanh player */
    .player{
      width:940px;max-width:96%;
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border-radius:16px;
      padding:18px;
      display:grid;
      grid-template-columns:260px 1fr;
      gap:18px;
      box-shadow:0 0 25px rgba(124,58,237,0.3), 0 10px 30px rgba(2,6,23,0.6);
      backdrop-filter:blur(10px);
      animation:glow 4s ease-in-out infinite alternate;
    }
    @keyframes glow {
      0%{box-shadow:0 0 15px rgba(124,58,237,0.25),0 0 40px rgba(96,165,250,0.1);}
      100%{box-shadow:0 0 25px rgba(124,58,237,0.45),0 0 60px rgba(96,165,250,0.25);}
    }

    .left{background:var(--card);border-radius:12px;padding:14px;display:flex;flex-direction:column;align-items:center}
    .cover{width:200px;height:200px;border-radius:12px;background:linear-gradient(135deg,#0e1b2b,#1a2750);display:flex;align-items:center;justify-content:center;color:var(--muted);font-weight:700;font-size:42px;box-shadow:0 0 15px rgba(124,58,237,0.3);}
    .meta{text-align:center;margin-top:12px}
    .meta h3{margin:6px 0 0;font-size:16px}
    .meta p{margin:4px 0 0;color:var(--muted);font-size:13px}

    .playlist{margin-top:14px;width:100%;overflow:auto;max-height:260px;padding:6px;border-radius:8px;background:var(--glass)}
    .track{padding:8px 10px;border-radius:8px;display:flex;align-items:center;gap:10px;cursor:pointer;transition:background 0.2s}
    .track:hover{background:rgba(255,255,255,0.05)}
    .track.active{background:linear-gradient(90deg, rgba(124,58,237,0.15), rgba(124,58,237,0.07));outline:1px solid rgba(124,58,237,0.15)}

    .right{display:flex;flex-direction:column;gap:12px}
    .controls{display:flex;align-items:center;gap:12px;justify-content:center}
    button{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px;border-radius:10px;color:inherit;cursor:pointer;transition:all .25s ease}
    button:hover{background:rgba(124,58,237,0.2);transform:scale(1.08);box-shadow:0 0 10px rgba(124,58,237,0.4);}
    .big{padding:14px;border-radius:14px;font-size:18px}

    .progress{width:100%;height:10px;background:rgba(255,255,255,0.06);border-radius:999px;cursor:pointer;overflow:hidden}
    .progress>i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#60a5fa);border-radius:999px;transition:width 0.25s}
    .time{display:flex;justify-content:space-between;color:var(--muted);font-size:13px}

    .row{display:flex;gap:10px;align-items:center}
    .playlist-controls{display:flex;gap:8px;align-items:center}

    input[type="file"]{display:none}

    .dropzone{border:2px dashed rgba(255,255,255,0.08);padding:12px;border-radius:10px;text-align:center;color:var(--muted);font-size:13px;transition:0.3s}
    .dropzone:hover{border-color:rgba(124,58,237,0.6);color:#ccc}
    .small{font-size:13px;color:var(--muted)}

    @media(max-width:720px){.player{grid-template-columns:1fr;}}
  </style>
</head>
<body>
  <!-- üëá To√†n b·ªô ph·∫ßn HTML & JS b·∫°n g·ª≠i gi·ªØ nguy√™n -->
  <!-- (code JS v√† c√°c ch·ª©c nƒÉng load nh·∫°c, ph√°t, l∆∞u, vv. kh√¥ng ƒë·ªïi) -->
  <!-- D√°n l·∫°i to√†n b·ªô ph·∫ßn <body> b·∫°n g·ª≠i ·ªü tr√™n -->
    <div class="player" id="player">
    <div class="left">
      <div class="cover" id="cover">‚ô™</div>
      <div class="meta">
        <h3 id="title">Kh√¥ng c√≥ b√†i h√°t</h3>
        <p id="artist">Th√™m b√†i h√°t ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</p>
      </div>

      <div class="playlist" id="playlist"></div>

      <div style="width:100%;margin-top:10px">
        <label class="dropzone" id="dropzone">K√©o & th·∫£ file √¢m thanh v√†o ƒë√¢y ‚Äî ho·∫∑c <button id="addBtn">th√™m</button>
          <input type="file" id="fileInput" accept="audio/*" multiple>
        </label>
        <div style="display:flex;justify-content:space-between;margin-top:8px">
          <div class="small">H·ªó tr·ª£: mp3, wav, m4a, ogg</div>
          <div class="playlist-controls">
            <button id="shuffleBtn" title="B·∫≠t/t·∫Øt shuffle">üîÄ</button>
            <button id="repeatBtn" title="L·∫∑p 1/All/Off">üîÅ</button>
          </div>
        </div>
      </div>
    </div>

    <div class="right">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="small">Web Music Player</div>
        <div class="small">K√Ω ph√≠m: Space = Play/Pause</div>
      </div>

      <div>
        <div class="controls">
          <button id="prevBtn">‚èÆ</button>
          <button id="playBtn" class="big">‚ñ∂Ô∏è</button>
          <button id="nextBtn">‚è≠</button>
          <button id="stopBtn">‚èπ</button>
        </div>
      </div>

      <div>
        <div class="progress" id="progress" title="B·∫•m ho·∫∑c k√©o ƒë·ªÉ nh·∫£y">
          <i></i>
        </div>
        <div class="time"><span id="curTime">0:00</span><span id="durTime">0:00</span></div>
      </div>

      <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
        <div class="row">
          <label class="small">√Çm l∆∞·ª£ng</label>
          <input type="range" id="volume" min="0" max="1" step="0.01" value="0.9">
        </div>
        <div class="row">
          <button id="downloadBtn" title="T·∫£i track hi·ªán t·∫°i">‚¨áÔ∏è</button>
        </div>
      </div>

      <div style="flex:1;display:flex;align-items:center;justify-content:center;color:var(--muted)">
        <div class="small">ƒê∆∞·ª£c l√†m b·ªüi banglegen</div>
      </div>
    </div>
  </div>

  <audio id="audio"></audio>

  <script>
    // Simple playlist manager
    const audio = document.getElementById('audio');
    const playBtn = document.getElementById('playBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const stopBtn = document.getElementById('stopBtn');
    const playlistEl = document.getElementById('playlist');
    const titleEl = document.getElementById('title');
    const artistEl = document.getElementById('artist');
    const coverEl = document.getElementById('cover');
    const progress = document.getElementById('progress');
    const progressBar = progress.querySelector('i');
    const curTime = document.getElementById('curTime');
    const durTime = document.getElementById('durTime');
    const fileInput = document.getElementById('fileInput');
    const addBtn = document.getElementById('addBtn');
    const dropzone = document.getElementById('dropzone');
    const volume = document.getElementById('volume');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const repeatBtn = document.getElementById('repeatBtn');
    const downloadBtn = document.getElementById('downloadBtn');

    let tracks = []; // {name, url, file}
    let idx = -1;
    let isShuffled = false;
    let repeatMode = 0; // 0=off,1=all,2=one

    // Helpers
    function formatTime(s){
      if (!isFinite(s)) return '0:00';
      s = Math.floor(s);
      const m = Math.floor(s/60);
      const sec = s%60;
      return m + ':' + (sec<10?'0':'') + sec;
    }

    function renderPlaylist(){
      playlistEl.innerHTML = '';
      tracks.forEach((t,i)=>{
        const div = document.createElement('div');
        div.className = 'track' + (i===idx? ' active':'');
        div.innerHTML = `
          <div style="flex:1;min-width:0">
            <div style="font-weight:600;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${t.name}</div>
            <div style="font-size:12px;color:var(--muted);">${t.artist||''}</div>
          </div>
          <div style="margin-left:8px;color:var(--muted);font-size:12px">${t.duration||''}</div>
        `;
        div.onclick = ()=>{playIndex(i)};
        playlistEl.appendChild(div);
      });
    }

    function playIndex(i){
      if (i<0 || i>=tracks.length) return;
      idx = i;
      const t = tracks[idx];
      audio.src = t.url;
      audio.play();
      updateMeta(t);
      renderPlaylist();
      playBtn.textContent = '‚è∏Ô∏è';
    }

    function updateMeta(t){
      titleEl.textContent = t.name || 'Unknown';
      artistEl.textContent = t.file ? (t.file.type || '') : '';
      coverEl.textContent = t.name.charAt(0).toUpperCase();
    }

    // Controls
    playBtn.onclick = ()=>{
      if (audio.paused) { audio.play(); playBtn.textContent = '‚è∏Ô∏è'; }
      else { audio.pause(); playBtn.textContent = '‚ñ∂Ô∏è'; }
    }
    prevBtn.onclick = ()=>{
      if (tracks.length===0) return;
      if (isShuffled) playIndex(Math.floor(Math.random()*tracks.length));
      else playIndex((idx-1+tracks.length)%tracks.length);
    }
    nextBtn.onclick = ()=>{
      if (tracks.length===0) return;
      if (isShuffled) playIndex(Math.floor(Math.random()*tracks.length));
      else playIndex((idx+1)%tracks.length);
    }
    stopBtn.onclick = ()=>{ audio.pause(); audio.currentTime = 0; playBtn.textContent = '‚ñ∂Ô∏è'; }

    // Progress
    audio.ontimeupdate = ()=>{
      const pct = audio.currentTime / (audio.duration||1) * 100;
      progressBar.style.width = pct + '%';
      curTime.textContent = formatTime(audio.currentTime);
      durTime.textContent = formatTime(audio.duration);
    }
    progress.onclick = (e)=>{
      const rect = progress.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const pct = x/rect.width;
      audio.currentTime = pct * (audio.duration||0);
    }

    // End behaviour
    audio.onended = ()=>{
      if (repeatMode===2) { audio.currentTime = 0; audio.play(); }
      else if (isShuffled) playIndex(Math.floor(Math.random()*tracks.length));
      else {
        if (idx < tracks.length-1) playIndex(idx+1);
        else { if (repeatMode===1) playIndex(0); else { playBtn.textContent='‚ñ∂Ô∏è'; }}
      }
    }

    // Files
    addBtn.onclick = ()=> fileInput.click();
    fileInput.onchange = async (e)=>{ handleFiles(e.target.files); fileInput.value=''; }

    async function handleFiles(fileList){
      const arr = Array.from(fileList).filter(f=>f.type.startsWith('audio') || f.name.match(/\.(mp3|m4a|wav|ogg|flac)$/i));
      for (const f of arr){
        const url = URL.createObjectURL(f);
        const name = f.name.replace(/\.[^/.]+$/,'');
        tracks.push({name, url, file: f});
      }
      // Read durations (simple approach)
      await Promise.all(tracks.map((t, i)=> loadDuration(i)));
      if (idx===-1 && tracks.length) playIndex(0);
      renderPlaylist();
    }

    function loadDuration(i){
      return new Promise(res =>{
        const a = document.createElement('audio');
        a.preload='metadata';
        a.src = tracks[i].url;
        a.onloadedmetadata = ()=>{
          tracks[i].duration = formatTime(a.duration);
          res();
        }
        a.onerror = ()=>{ tracks[i].duration = ''; res(); }
      });
    }

    // Drag & drop
    ['dragenter','dragover'].forEach(ev=>{
      dropzone.addEventListener(ev, (e)=>{e.preventDefault(); dropzone.style.borderColor='rgba(124,58,237,0.7)'});
    });
    ['dragleave','drop'].forEach(ev=>{
      dropzone.addEventListener(ev, (e)=>{e.preventDefault(); dropzone.style.borderColor='';});
    });
    dropzone.addEventListener('drop', (e)=>{ const dt = e.dataTransfer; if (dt && dt.files) handleFiles(dt.files); });

    // Volume
    volume.oninput = ()=>{ audio.volume = parseFloat(volume.value); }
    audio.volume = parseFloat(volume.value);

    // Shuffle & repeat
    shuffleBtn.onclick = ()=>{ isShuffled = !isShuffled; shuffleBtn.style.opacity = isShuffled?1:0.6 }
    repeatBtn.onclick = ()=>{ repeatMode = (repeatMode+1)%3; repeatBtn.style.opacity= repeatMode?1:0.6; repeatBtn.textContent = repeatMode===2? 'üîÇ' : 'üîÅ'; }

    // Keyboard
    window.addEventListener('keydown', (e)=>{
      if (e.code === 'Space') { e.preventDefault(); playBtn.click(); }
      if (e.code === 'ArrowRight') nextBtn.click();
      if (e.code === 'ArrowLeft') prevBtn.click();
    });

    // Download current track (if local file)
    downloadBtn.onclick = ()=>{
      if (idx<0) return;
      const t = tracks[idx];
      if (!t.file){ alert('Track kh√¥ng c√≥ file ƒë·ªÉ t·∫£i (c√≥ th·ªÉ l√† remote URL).'); return; }
      const a = document.createElement('a'); a.href = t.url; a.download = t.file.name; a.click();
    }

    // Simple persistence using localStorage (store names and blobs not stored ‚Äî we store only metadata URLs are blob: and won't persist after reload)
    // If you'd like real persistence, we can add IndexedDB saving of files.

    // Expose small debug helpers
    window._tracks = tracks;
  </script>
</body>
</html>
